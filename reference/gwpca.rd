<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>GWPCA — gwpca • GWmodel</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="GWPCA — gwpca"><meta property="og:description" content="This function implements basic or robust GWPCA."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GWmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>GWPCA</h1>

    <div class="hidden name"><code>gwpca.rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function implements basic or robust GWPCA.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gwpca</span><span class="op">(</span><span class="va">data</span>, <span class="va">elocat</span>, <span class="va">vars</span>, k <span class="op">=</span> <span class="fl">2</span>, robust <span class="op">=</span> <span class="cn">FALSE</span>, scaling<span class="op">=</span><span class="cn">T</span>, kernel <span class="op">=</span> <span class="st">"bisquare"</span>,</span>
<span>                  adaptive <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">bw</span>, p <span class="op">=</span> <span class="fl">2</span>, theta <span class="op">=</span> <span class="fl">0</span>, longlat <span class="op">=</span> <span class="cn">F</span>, cv <span class="op">=</span> <span class="cn">T</span>, scores<span class="op">=</span><span class="cn">F</span>,</span>
<span>                  <span class="va">dMat</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'gwpca'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a Spatial*DataFrame, i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span>, or a sf object defined in package <span class="pkg">sf</span></p></dd>

  <dt id="arg-elocat">elocat<a class="anchor" aria-label="anchor" href="#arg-elocat"></a></dt>
<dd><p>a two-column numeric array or Spatial*DataFrame object for providing evaluation locations,
                       i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame
                       as defined in package <span class="pkg">sp</span></p></dd>

  <dt id="arg-vars">vars<a class="anchor" aria-label="anchor" href="#arg-vars"></a></dt>
<dd><p>a vector of variable names to be evaluated</p></dd>

  <dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>the number of retained components; k must be less than the number of variables</p></dd>

  <dt id="arg-robust">robust<a class="anchor" aria-label="anchor" href="#arg-robust"></a></dt>
<dd><p>if TRUE, robust GWPCA will be applied; otherwise basic GWPCA will be applied</p></dd>

  <dt id="arg-scaling">scaling<a class="anchor" aria-label="anchor" href="#arg-scaling"></a></dt>
<dd><p>if TRUE,  the data is scaled to have zero mean and unit variance (standardized);
                otherwise the data is centered but not scaled</p></dd>

  <dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>function chosen as follows:</p>
<p>gaussian: wgt = exp(-.5*(vdist/bw)^2);</p>
<p>exponential: wgt = exp(-vdist/bw);</p>
<p>bisquare: wgt = (1-(vdist/bw)^2)^2 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>tricube: wgt = (1-(vdist/bw)^3)^3 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>boxcar: wgt=1 if dist &lt; bw, wgt=0 otherwise</p></dd>

  <dt id="arg-adaptive">adaptive<a class="anchor" aria-label="anchor" href="#arg-adaptive"></a></dt>
<dd><p>if TRUE calculate an adaptive kernel where the bandwidth corresponds to the number of nearest neighbours (i.e. adaptive distance); default is FALSE, where a fixed kernel is found (bandwidth is a fixed distance)</p></dd>

  <dt id="arg-bw">bw<a class="anchor" aria-label="anchor" href="#arg-bw"></a></dt>
<dd><p>bandwidth used in the weighting function, possibly calculated by <a href="bw.gwpca.html">bw.gwpca</a>;fixed (distance) or adaptive bandwidth(number of nearest neighbours)</p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>the power of the Minkowski distance, default is 2, i.e. the Euclidean distance</p></dd>

  <dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>an angle in radians to rotate the coordinate system, default is 0</p></dd>

  <dt id="arg-longlat">longlat<a class="anchor" aria-label="anchor" href="#arg-longlat"></a></dt>
<dd><p>if TRUE, great circle distances will be calculated</p></dd>

  <dt id="arg-cv">cv<a class="anchor" aria-label="anchor" href="#arg-cv"></a></dt>
<dd><p>If TRUE, cross-validation data will be found that are used to calculate the cross-validation score for the specified bandwidth.</p></dd>

  <dt id="arg-scores">scores<a class="anchor" aria-label="anchor" href="#arg-scores"></a></dt>
<dd><p>if scores = TRUE, the scores of the supplied data on the principal components will be calculated.</p></dd>

  <dt id="arg-dmat">dMat<a class="anchor" aria-label="anchor" href="#arg-dmat"></a></dt>
<dd><p>a pre-specified distance matrix, it can be calculated by the function <code><a href="gw.dist.html">gw.dist</a></code></p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class “gwpca”, returned by the function <code>gwpca</code></p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed through (unused)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class “gwpca”:</p>
<dl><dt>GW.arguments</dt>
<dd><p>a list class object including the model fitting parameters for generating the report file</p></dd>

  <dt>pca</dt>
<dd><p>an object of class inheriting from “princomp”, see <a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a>.</p></dd>

  <dt>loadings</dt>
<dd><p>the localised loadings</p></dd>

  <dt>SDF</dt>
<dd><p>a SpatialPointsDataFrame (may be gridded) or
             SpatialPolygonsDataFrame object (see package “sp”) or sf object  (see package “sf”)
             integrated with local proportions of variance for each
             principle components, cumulative proportion and winning variable for the 1st principle component in its "data" slot.</p></dd>

  <dt>gwpca.scores</dt>
<dd><p>the localised scores of the supplied data on the principal components</p></dd>

  <dt>var</dt>
<dd><p>The local amount of variance accounted for by each component</p></dd>

  <dt>CV</dt>
<dd><p>Vector of cross-validation data</p></dd>

  <dt>timings</dt>
<dd><p>starting and ending time.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Fotheringham S, Brunsdon, C, and Charlton, M (2002),
Geographically Weighted Regression: The Analysis of Spatially Varying Relationships, Chichester: Wiley.</p>
<p>Harris P, Brunsdon C, Charlton M (2011)
Geographically weighted principal components analysis.
International Journal of Geographical Information Science 25:1717-1736</p>
<p>Harris P, Brunsdon C, Charlton M, Juggins S, Clarke A (2014) Multivariate spatial
outlier detection using robust geographically weighted methods.  Mathematical
 Geosciences 46(1) 1-31</p>
<p>Harris P, Clarke A, Juggins S, Brunsdon C, Charlton M (2014) Geographically
weighted methods and their use in network re-designs for environmental monitoring.
Stochastic Environmental Research and Risk Assessment 28: 1869-1887</p>
<p>Harris P, Clarke A, Juggins S, Brunsdon C, Charlton M (2015) Enhancements to a
geographically weighted principal components analysis in the context of an
application to an environmental data set.  Geographical Analysis 47: 146-172</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Binbin Lu <a href="mailto:binbinlu@whu.edu.cn">binbinlu@whu.edu.cn</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://cstat.tuwien.ac.at/filz/" class="external-link">"mvoutlier"</a></span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bsstop</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Data.1</span> <span class="op">&lt;-</span> <span class="va">bsstop</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">14</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Data.1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">Data.1.scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Data.1</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="co"># standardised data...</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Data.1.scaled</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">Data.1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co">#compute principal components:</span></span></span>
<span class="r-in"><span>  <span class="va">pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></span><span class="op">(</span><span class="va">Data.1.scaled</span>, cor <span class="op">=</span> <span class="cn">FALSE</span>, scores <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span></span>
<span class="r-in"><span>  <span class="co"># use covariance matrix to match the following...</span></span></span>
<span class="r-in"><span>  <span class="va">pca</span><span class="op">$</span><span class="va">loadings</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bss.background</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">backdrop</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bss.background</span>, asp <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"l"</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, </span></span>
<span class="r-in"><span>   xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, bty <span class="op">=</span> <span class="st">"n"</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pc1</span> <span class="op">&lt;-</span> <span class="va">pca</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu">backdrop</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">Data.1</span><span class="op">$</span><span class="va">XCOO</span><span class="op">[</span><span class="va">pc1</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, <span class="va">Data.1</span><span class="op">$</span><span class="va">YCOO</span><span class="op">[</span><span class="va">pc1</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">Data.1</span><span class="op">$</span><span class="va">XCOO</span><span class="op">[</span><span class="va">pc1</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span>, <span class="va">Data.1</span><span class="op">$</span><span class="va">YCOO</span><span class="op">[</span><span class="va">pc1</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#Geographically Weighted PCA and mapping the local loadings</span></span></span>
<span class="r-in"><span>  <span class="co"># Coordinates of the sites</span></span></span>
<span class="r-in"><span>  <span class="va">Coords1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Data.1</span><span class="op">$</span><span class="va">XCOO</span>,<span class="va">Data.1</span><span class="op">$</span><span class="va">YCOO</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">d1s</span> <span class="op">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span><span class="op">(</span><span class="va">Coords1</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Data.1.scaled</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pca.gw</span> <span class="op">&lt;-</span> <span class="fu">gwpca</span><span class="op">(</span><span class="va">d1s</span>,vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">d1s</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>,bw<span class="op">=</span><span class="fl">1000000</span>,k<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">local.loadings</span> <span class="op">&lt;-</span> <span class="va">pca.gw</span><span class="op">$</span><span class="va">loadings</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span>  </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Mapping the winning variable with the highest absolute loading</span></span></span>
<span class="r-in"><span>  <span class="co"># note first component only - would need to explore all components..</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">lead.item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">local.loadings</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/maxCol.html" class="external-link">max.col</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">local.loadings</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">df1p</span> <span class="op">=</span> <span class="fu">SpatialPointsDataFrame</span><span class="op">(</span><span class="va">Coords1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lead <span class="op">=</span> <span class="va">lead.item</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">backdrop</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">df1p</span><span class="op">$</span><span class="va">lead</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df1p</span><span class="op">$</span><span class="va">lead</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df1p</span>, pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="va">colour</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df1p</span><span class="op">$</span><span class="va">lead</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> </span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">backdrop</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#Glyph plots give a view of all the local loadings together</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gwpca.glyph.plot.html">glyph.plot</a></span><span class="op">(</span><span class="va">local.loadings</span>, <span class="va">Coords1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co">#it is not immediately clear how to interpret the glyphs fully, </span></span></span>
<span class="r-in"><span>  <span class="co">#so inter-actively identify the full loading information using:</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gwpca.check.components.html">check.components</a></span><span class="op">(</span><span class="va">local.loadings</span>, <span class="va">Coords1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># GWPCA with an optimal bandwidth</span></span></span>
<span class="r-in"><span>  <span class="va">bw.choice</span> <span class="op">&lt;-</span> <span class="fu"><a href="bw.gwpca.html">bw.gwpca</a></span><span class="op">(</span><span class="va">d1s</span>,vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">d1s</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>,k<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="va">pca.gw.auto</span>  <span class="op">&lt;-</span> <span class="fu">gwpca</span><span class="op">(</span><span class="va">d1s</span>,vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">d1s</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>,bw<span class="op">=</span><span class="va">bw.choice</span>,k<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># note first component only - would need to explore all components..</span></span></span>
<span class="r-in"><span>  <span class="va">local.loadings</span> <span class="op">&lt;-</span> <span class="va">pca.gw.auto</span><span class="op">$</span><span class="va">loadings</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span>  </span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="va">lead.item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">local.loadings</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/maxCol.html" class="external-link">max.col</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">local.loadings</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">df1p</span> <span class="op">=</span> <span class="fu">SpatialPointsDataFrame</span><span class="op">(</span><span class="va">Coords1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lead <span class="op">=</span> <span class="va">lead.item</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">backdrop</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">colour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">df1p</span><span class="op">$</span><span class="va">lead</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df1p</span><span class="op">$</span><span class="va">lead</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df1p</span>, pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="va">colour</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df1p</span><span class="op">$</span><span class="va">lead</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">18</span>, </span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># GWPCPLOT for investigating the raw multivariate data</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="gw.pcplot.html">gw.pcplot</a></span><span class="op">(</span><span class="va">d1s</span>, vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">d1s</span><span class="op">@</span><span class="va">data</span><span class="op">)</span>,focus<span class="op">=</span><span class="fl">359</span>, bw <span class="op">=</span> <span class="va">bw.choice</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Binbin Lu, Paul Harris, Martin Charlton, Chris Brunsdon, Tomoki Nakaya.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

