<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Model selection for GWR with a given set of independent variables — gwr.model.selection • GWmodel</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Model selection for GWR with a given set of independent variables — gwr.model.selection"><meta property="og:description" content="This function selects one GWR model from many alternatives based on the AICc values."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GWmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Model selection for GWR with a given set of independent variables</h1>

    <div class="hidden name"><code>gwr.model.selection.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function selects one GWR model from many alternatives based on the AICc values.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gwr.model.selection</span><span class="op">(</span>DeVar<span class="op">=</span><span class="cn">NULL</span>,InDeVars<span class="op">=</span><span class="cn">NULL</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,bw<span class="op">=</span><span class="cn">NULL</span>,approach<span class="op">=</span><span class="st">"CV"</span>,</span>
<span>               adaptive<span class="op">=</span><span class="cn">F</span>,kernel<span class="op">=</span><span class="st">"bisquare"</span>,dMat<span class="op">=</span><span class="cn">NULL</span>,p<span class="op">=</span><span class="fl">2</span>, theta<span class="op">=</span><span class="fl">0</span>, longlat<span class="op">=</span><span class="cn">F</span>,</span>
<span>               parallel.method<span class="op">=</span><span class="cn">F</span>,parallel.arg<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-devar">DeVar<a class="anchor" aria-label="anchor" href="#arg-devar"></a></dt>
<dd><p>dependent variable</p></dd>

  <dt id="arg-indevars">InDeVars<a class="anchor" aria-label="anchor" href="#arg-indevars"></a></dt>
<dd><p>a vector of independent variables for model selection</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a Spatial*DataFrame, i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span>, or a sf object defined in package <span class="pkg">sf</span></p></dd>

  <dt id="arg-bw">bw<a class="anchor" aria-label="anchor" href="#arg-bw"></a></dt>
<dd><p>bandwidth used in the weighting function, possibly calculated by <code><a href="bw.gwr.html">bw.gwr</a></code></p></dd>

  <dt id="arg-approach">approach<a class="anchor" aria-label="anchor" href="#arg-approach"></a></dt>
<dd><p>specified by <b>CV</b> (<b>cv</b>) for cross validation approach or <b>AIC</b> (<b>aic</b>)
                  for selecting bandwidth by AICc values</p></dd>

  <dt id="arg-adaptive">adaptive<a class="anchor" aria-label="anchor" href="#arg-adaptive"></a></dt>
<dd><p>if TRUE calculate an adaptive kernel where the bandwidth (bw) corresponds to the number of nearest neighbours (i.e. adaptive distance); default is FALSE, where a fixed kernel is found (bandwidth is a fixed distance)</p></dd>

  <dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>function chosen as follows:</p>
<p>gaussian: wgt = exp(-.5*(vdist/bw)^2);</p>
<p>exponential: wgt = exp(-vdist/bw);</p>
<p>bisquare: wgt = (1-(vdist/bw)^2)^2 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>tricube: wgt = (1-(vdist/bw)^3)^3 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>boxcar: wgt=1 if dist &lt; bw, wgt=0 otherwise</p></dd>

  <dt id="arg-dmat">dMat<a class="anchor" aria-label="anchor" href="#arg-dmat"></a></dt>
<dd><p>a pre-specified distance matrix, it can be calculated by the function <code><a href="gw.dist.html">gw.dist</a></code></p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>the power of the Minkowski distance, default is 2, i.e. the Euclidean distance</p></dd>

  <dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>an angle in radians to rotate the coordinate system, default is 0</p></dd>

  <dt id="arg-longlat">longlat<a class="anchor" aria-label="anchor" href="#arg-longlat"></a></dt>
<dd><p>if TRUE, great circle distances will be calculated</p></dd>

  <dt id="arg-parallel-method">parallel.method<a class="anchor" aria-label="anchor" href="#arg-parallel-method"></a></dt>
<dd><p>Specified by `FALSE` for serial approach,
                         by `"omp"` for multi-thread approach implemented via OpenMP,
                         by `"cluster"` for multi-process approach implemented via `parallel` package,
                         by `"cuda"` for parallel approach implemented via CUDA</p></dd>

  <dt id="arg-parallel-arg">parallel.arg<a class="anchor" aria-label="anchor" href="#arg-parallel-arg"></a></dt>
<dd><p>Set the argument for parallel approach.
                      If `parallel.method` is `FALSE`, there is no need to set its value.
                      If `parallel.method` is `"omp"`, its value is used to set how many threads should be created (default by cores of *cores of CPU* - 1).
                      If `parallel.method` is `"cluster"`, its value is used to set how many R session should be created (default by cores of *cores of CPU* - 1).
                      If `parallel.method` is `"cuda"`, its value is used to set how many samples is included in one group during the calibration. This value should not be too big to avoid the overflow of GPU memory.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of:</p>
<dl><dt>model.list</dt>
<dd><p>a list of all the tried GWR models consisted of formulas and variables.</p></dd>

  <dt>GWR.df</dt>
<dd><p>a data frame consited of four columns: bandwidth, AIC, AICc, RSS</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Binbin Lu <a href="mailto:binbinlu@whu.edu.cn">binbinlu@whu.edu.cn</a></p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The algorithm for selecting GWR models consists of the following four steps:</p>
<p>Step 1. Start by calibrating all the possible bivariate GWR models by sequentially regressing
a single independent variable against the dependent variable;</p>
<p>Step 2. Find the best performing model which produces the minimum AICc value, and permanently include the corresponding independent
variable in subsequent models;</p>
<p>Step 3. Sequentially introduce a variable from the remaining
group of independent variables to construct new models with the permanently included independent variables,
and determine the next permanently included variable from the best fitting model that has
the minimum AICc value;</p>
<p>Step 4. Repeat step 3 until all the independent variables are permanently
included in the model.</p>
<p>In this procedure, the independent variables are iteratively included into the model in a "forward" direction.
Note that there is a clear distinction between the different number of involved variables in a
selection step, which can be called model levels.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Lu, B, Charlton, M, Harris, P, Fotheringham, AS (2014) Geographically weighted regression
with a non-Euclidean distance metric: a case study using hedonic house price data.
International Journal of Geographical Information Science 28(4): 660-681</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gwr.model.view.html">gwr.model.view</a></code>, <code><a href="gwr.model.sort.html">gwr.model.sort</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Binbin Lu, Paul Harris, Martin Charlton, Chris Brunsdon, Tomoki Nakaya.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

