<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multiscale GWR — gwr.multiscale • GWmodel</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multiscale GWR — gwr.multiscale"><meta property="og:description" content="This function implements multiscale GWR to detect variations in regression relationships across
different spatial scales. This function can not only find a different bandwidth for each
relationship but also (and simultaneously) find a different distance metric for
each relationship (if required to do so)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GWmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiscale GWR</h1>

    <div class="hidden name"><code>gwr.multiscale.rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function implements multiscale GWR to detect variations in regression relationships across
different spatial scales. This function can not only find a different bandwidth for each
relationship but also (and simultaneously) find a different distance metric for
each relationship (if required to do so).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gwr.multiscale</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, kernel <span class="op">=</span> <span class="st">"bisquare"</span>, adaptive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 criterion <span class="op">=</span> <span class="st">"dCVR"</span>, max.iterations <span class="op">=</span> <span class="fl">2000</span>, threshold <span class="op">=</span></span>
<span>                 <span class="fl">1e-05</span>, <span class="va">dMats</span>, <span class="va">var.dMat.indx</span>, <span class="va">p.vals</span>, <span class="va">theta.vals</span>,</span>
<span>                 longlat <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">bws0</span>, <span class="va">bw.seled</span>, approach <span class="op">=</span> <span class="st">"AIC"</span>, <span class="va">bws.thresholds</span>, </span>
<span>                 bws.reOpts <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                 hatmatrix <span class="op">=</span> <span class="cn">T</span>, predictor.centered <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">T</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bws0</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, nlower <span class="op">=</span> <span class="fl">10</span>, parallel.method <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                 parallel.arg <span class="op">=</span> <span class="cn">NULL</span>, force.armadillo <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'multiscalegwr'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Regression model formula of a <a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a> object</p></dd>

  <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a Spatial*DataFrame, i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span>, or a sf object defined in package <span class="pkg">sf</span></p></dd>

  <dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>function chosen as follows:</p>
<p>gaussian: wgt = exp(-.5*(vdist/bw)^2);</p>
<p>exponential: wgt = exp(-vdist/bw);</p>
<p>bisquare: wgt = (1-(vdist/bw)^2)^2 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>tricube: wgt = (1-(vdist/bw)^3)^3 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>boxcar: wgt=1 if dist &lt; bw, wgt=0 otherwise</p></dd>

  <dt id="arg-adaptive">adaptive<a class="anchor" aria-label="anchor" href="#arg-adaptive"></a></dt>
<dd><p>if TRUE calculate an adaptive kernel where the bandwidth (bw) corresponds to the number of nearest neighbours (i.e. adaptive distance); default is FALSE, where a fixed kernel is found (bandwidth is a fixed distance)</p></dd>

  <dt id="arg-criterion">criterion<a class="anchor" aria-label="anchor" href="#arg-criterion"></a></dt>
<dd><p>criterion for determining the convergence of the back-fitting procedure, could be "CVR" or "dCVR", which corespond to the changing value of RSS (CVR) and the differential version (dCVR), respectively; and "dCVR" is used as default.</p></dd>

  <dt id="arg-max-iterations">max.iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>maximum number of iterations in the back-fitting procedure</p></dd>

  <dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>threshold value to terminate the back-fitting iterations</p></dd>

  <dt id="arg-dmats">dMats<a class="anchor" aria-label="anchor" href="#arg-dmats"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> of distance matrices used for estimating each specific parameter</p></dd>

  <dt id="arg-var-dmat-indx">var.dMat.indx<a class="anchor" aria-label="anchor" href="#arg-var-dmat-indx"></a></dt>
<dd><p>index corresponds to a specific distance matrix for each exploratory variable, if dMats is provided</p></dd>

  <dt id="arg-p-vals">p.vals<a class="anchor" aria-label="anchor" href="#arg-p-vals"></a></dt>
<dd><p>a collection of positive numbers used as the power of the Minkowski distance</p></dd>

  <dt id="arg-theta-vals">theta.vals<a class="anchor" aria-label="anchor" href="#arg-theta-vals"></a></dt>
<dd><p>a collection of values used as angles in radians to rotate the coordinate system</p></dd>

  <dt id="arg-longlat">longlat<a class="anchor" aria-label="anchor" href="#arg-longlat"></a></dt>
<dd><p>if TRUE, great circle distances will be calculated</p></dd>

  <dt id="arg-bws-">bws0<a class="anchor" aria-label="anchor" href="#arg-bws-"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> of initializing bandwidths for the back-fitting procedure, of which the length should equal to the number of paramters if specified</p></dd>

  <dt id="arg-bw-seled">bw.seled<a class="anchor" aria-label="anchor" href="#arg-bw-seled"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a> of boolean variables to determine whether the corresponding bandwidth should be re-selected or not: if TRUE, the corresponding bandwiths for the specific parameters are                      supposed to be given in bws0; otherwise, the bandwidths for the specific parameters will be selected within the back-fitting iterations.</p></dd>

  <dt id="arg-approach">approach<a class="anchor" aria-label="anchor" href="#arg-approach"></a></dt>
<dd><p>specified by CV for cross-validation approach or by AIC corrected (AICc) approach</p></dd>

  <dt id="arg-bws-thresholds">bws.thresholds<a class="anchor" aria-label="anchor" href="#arg-bws-thresholds"></a></dt>
<dd><p>threshold values to define whether the bandwidth for a specific parameter has converged or not</p></dd>

  <dt id="arg-bws-reopts">bws.reOpts<a class="anchor" aria-label="anchor" href="#arg-bws-reopts"></a></dt>
<dd><p>the number times of continually optimizing each parameter-specific bandwidth even though it meets the criterion of convergence, for avoiding  sub-optimal choice due to illusion of                           convergence;</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>if TRUE and bandwidth selection is undertaken, the bandwidth searches are reported</p></dd>

  <dt id="arg-predictor-centered">predictor.centered<a class="anchor" aria-label="anchor" href="#arg-predictor-centered"></a></dt>
<dd><p>a logical vector of length equalling to the number of predictors, and note intercept is not included; if the element is TRUE, the corresponding predictor will be centered.</p></dd>

  <dt id="arg-hatmatrix">hatmatrix<a class="anchor" aria-label="anchor" href="#arg-hatmatrix"></a></dt>
<dd><p>if TRUE the hatmatrix for the whole model will be calculated, and AICc, adjusted-R2 values will be returned accordingly.</p></dd>

  <dt id="arg-nlower">nlower<a class="anchor" aria-label="anchor" href="#arg-nlower"></a></dt>
<dd><p>the minmum number of nearest neighbours if an adaptive kernel is used</p></dd>

  <dt id="arg-parallel-method">parallel.method<a class="anchor" aria-label="anchor" href="#arg-parallel-method"></a></dt>
<dd><p>FALSE as default, and the calibration will be conducted traditionally via the serial technique,
                         "omp": multi-thread technique with the OpenMP API,
                         "cluster": multi-process technique with the <span class="pkg">parallel</span> package,
                         "cuda": parallel computing technique with CUDA</p></dd>

  <dt id="arg-parallel-arg">parallel.arg<a class="anchor" aria-label="anchor" href="#arg-parallel-arg"></a></dt>
<dd><p>if parallel.method is not FALSE, then set the argument by following:
                      if parallel.method is "omp", parallel.arg refers to the number of threads used, and its default value is
                       the number of cores - 1;
                      if parallel.method is "cluster", parallel.arg refers to the number of R sessions used, and its default value is
                       the number of cores - 1;
                      if parallel.method is "cuda",  parallel.arg refers to the number of calibrations  included in each group,
                      but note a too large value may cause the overflow of GPU memory.</p></dd>

  <dt id="arg-force-armadillo">force.armadillo<a class="anchor" aria-label="anchor" href="#arg-force-armadillo"></a></dt>
<dd><p>if TRUE, use the original RcppArmadillo implementation instead of the new RcppEigen implementation. Only matters if parallel.method = F or parallel.method = "omp".</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class “multiscalegwr”, returned by the function gwr.multiscale</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed through (unused)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class “psdmgwr”:</p>
<dl><dt>SDF</dt>
<dd><p>a SpatialPointsDataFrame (may be gridded), or
             SpatialPolygonsDataFrame object (see package “sp”), or sf object  (see package “sf”)
             integrated with data locations,coefficient estimates from the PSDM GWR model,predicted y values,residuals,
              coefficient standard errors and t-values in its "data" slot.</p></dd>

  <dt>GW.arguments</dt>
<dd><p>a list class object including the model fitting parameters for generating the report file</p></dd>

  <dt>GW.diagnostic</dt>
<dd><p>a list class object including the diagnostic information of the model fitting</p></dd>

  <dt>lm</dt>
<dd><p>an object of class inheriting from “lm”, see <a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a>.</p></dd>

  <dt>bws.vars</dt>
<dd><p>bandwidths used for all the parameters within the back-fitting procedure</p></dd>

  <dt>timings</dt>
<dd><p>starting and ending time.</p></dd>

  <dt>this.call</dt>
<dd><p>the function call used.</p></dd>

</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>This function implements multiscale GWR to detect variations in regression
relationships across different spatial scales. This function can not only find
a different bandwidth for each relationship, but also (and simultaneously), find
 a different distance metric for each relationship (i.e. Parameter-Specific Distance
 Metric GWR, i.e. PSDM GWR).  Note that multiscale GWR (MGWR) has also been referred
 to as flexible bandwidth GWR (FBGWR) and conditional GWR (CGWR) in the literature.
 All are one and the same model, but where PSDM-GWR additionally provides a different
 distance metric option for each relationship.  An MGWR model is calibrated if no “dMats”
 and “p.vals” are specified; a mixed GWR model will be calibrated if an
 infinite bandwidth and another regular bandwidth are used for estimating the global and local
 parameters (again when no “dMats” and “p.vals” are specified).
 In other words, the gwr.multiscale function is specified with Euclidean distances
 in both cases. Note that the results from this function for a mixed GWR model
 and gwr.mixed might be different, as a back-fitting algorithm is used in
gwr.multiscale, while an approximating algorithm is applied in gwr.mixed.
The <a href="gwr.mixed.html">gwr.mixed</a> function performs better in computational efficiency, but
poorer in prediction accuracy.</p>
    </div>
    <div id="references">
    <h2>References</h2>


<p>Yang, W. (2014). An Extension of Geographically Weighted Regression with
Flexible Bandwidths. St Andrews, St Andrews, UK.</p>
<p>Lu, B., Harris, P., Charlton, M., &amp; Brunsdon, C. (2015). Calibrating a
Geographically Weighted Regression Model with Parameter-specific Distance
Metrics. Procedia Environmental Sciences, 26, 109-114.</p>
<p>Lu, B., Brunsdon, C., Charlton, M., &amp; Harris, P. (2017). Geographically weighted
regression with parameter-specific distance metrics. International Journal of
Geographical Information Science, 31, 982-998.</p>
<p>Fotheringham, A. S., Yang, W. &amp; Kang, W. (2017). Multiscale Geographically
Weighted Regression (MGWR). Annals of the American Association of Geographers,
107, 1247-1265.</p>
<p>Yu, H., A. S. Fotheringham, Z. Li, T. Oshan, W. Kang &amp; L. J. Wolf. 2019. Inference
in multiscale geographically weighted regression. Geographical Analysis(In press).</p>
<p>Leong, Y.Y., &amp; Yue, J.C. (2017). A modification to geographically weighted
regression. International Journal of Health Geographics, 16 (1), 11.</p>
<p>Lu, B., Yang, W. Ge, Y. &amp; Harris, P. (2018). Improvements to the calibration of
a geographically weighted regression with parameter-specific distance metrics
and bandwidths. Forthcoming Computers, Environment and Urban Systems.</p>
<p>Wolf, L.J, Oshan, T.M, Fotheringham, A.S. (2018). Single and multiscale models of
process spatial heterogeneity. Geographical Analysis, 50(3): 223-246.</p>
<p>Murakami, D., Lu, B., Harris, P., Brunsdon, C., Charlton, M., Nakaya, T., &amp; Griffith, D. (2019)
The importance of scale in spatially varying coefficient modelling.
Forthcoming Annals of the Association of American Geographers.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Binbin Lu <a href="mailto:binbinlu@whu.edu.cn">binbinlu@whu.edu.cn</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">LondonHP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">EUDM</span> <span class="op">&lt;-</span> <span class="fu"><a href="gw.dist.html">gw.dist</a></span><span class="op">(</span><span class="fu">coordinates</span><span class="op">(</span><span class="va">londonhp</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#No bandwidth is selected, and bws0 values are used</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">###Similar as the basic GWR</span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">&lt;-</span><span class="fu">gwr.multiscale</span><span class="op">(</span><span class="va">PURCHASE</span><span class="op">~</span><span class="va">FLOORSZ</span><span class="op">+</span><span class="va">PROF</span>, data<span class="op">=</span><span class="va">londonhp</span>, criterion<span class="op">=</span><span class="st">"dCVR"</span>,kernel<span class="op">=</span><span class="st">"gaussian"</span>, </span></span>
<span class="r-in"><span>adaptive<span class="op">=</span><span class="cn">T</span>, bws0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>,bw.seled<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">T</span>, <span class="fl">3</span><span class="op">)</span>, dMats<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">EUDM</span>,<span class="va">EUDM</span>,<span class="va">EUDM</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#FBGWR</span></span></span>
<span class="r-in"><span><span class="va">res2</span><span class="op">&lt;-</span><span class="fu">gwr.multiscale</span><span class="op">(</span><span class="va">PURCHASE</span><span class="op">~</span><span class="va">FLOORSZ</span><span class="op">+</span><span class="va">PROF</span>, data<span class="op">=</span><span class="va">londonhp</span>, criterion<span class="op">=</span><span class="st">"dCVR"</span>,kernel<span class="op">=</span><span class="st">"gaussian"</span>,</span></span>
<span class="r-in"><span>adaptive<span class="op">=</span><span class="cn">T</span>, bws0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, dMats<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">EUDM</span>,<span class="va">EUDM</span>,<span class="va">EUDM</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Mixed GWR</span></span></span>
<span class="r-in"><span><span class="va">res3</span><span class="op">&lt;-</span><span class="fu">gwr.multiscale</span><span class="op">(</span><span class="va">PURCHASE</span><span class="op">~</span><span class="va">FLOORSZ</span><span class="op">+</span><span class="va">PROF</span>, data<span class="op">=</span><span class="va">londonhp</span>, bws0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               bw.seled<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">T</span>, <span class="fl">3</span><span class="op">)</span>,kernel<span class="op">=</span><span class="st">"gaussian"</span>, dMats<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">EUDM</span>,<span class="va">EUDM</span>,<span class="va">EUDM</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#PSDM GWR</span></span></span>
<span class="r-in"><span><span class="va">res4</span><span class="op">&lt;-</span> <span class="fu">gwr.multiscale</span><span class="op">(</span><span class="va">PURCHASE</span><span class="op">~</span><span class="va">FLOORSZ</span><span class="op">+</span><span class="va">PROF</span>, data<span class="op">=</span><span class="va">londonhp</span>, kernel<span class="op">=</span><span class="st">"gaussian"</span>, p.vals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Binbin Lu, Paul Harris, Martin Charlton, Chris Brunsdon, Tomoki Nakaya.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

