<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Geographically weighted summary statistics (GWSS) — gwss • GWmodel</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Geographically weighted summary statistics (GWSS) — gwss"><meta property="og:description" content="This function calculates basic and robust GWSS.  This includes geographically weighted means, standard deviations and skew. Robust alternatives include geographically weighted medians, inter-quartile ranges and quantile imbalances. This function also calculates basic geographically weighted covariances together with basic and robust
geographically weighted correlations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GWmodel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Geographically weighted summary statistics (GWSS)</h1>

    <div class="hidden name"><code>gwss.rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates basic and robust GWSS.  This includes geographically weighted means, standard deviations and skew. Robust alternatives include geographically weighted medians, inter-quartile ranges and quantile imbalances. This function also calculates basic geographically weighted covariances together with basic and robust
geographically weighted correlations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gwss</span><span class="op">(</span><span class="va">data</span>, <span class="va">summary.locat</span>,<span class="va">vars</span>,kernel<span class="op">=</span><span class="st">"bisquare"</span>,adaptive<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">bw</span>,p<span class="op">=</span><span class="fl">2</span>, </span>
<span>            theta<span class="op">=</span><span class="fl">0</span>, longlat<span class="op">=</span><span class="cn">F</span>,<span class="va">dMat</span>,quantile<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># S3 method for class 'gwss'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a Spatial*DataFrame, i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame as defined in package <span class="pkg">sp</span></p></dd>

  <dt id="arg-summary-locat">summary.locat<a class="anchor" aria-label="anchor" href="#arg-summary-locat"></a></dt>
<dd><p>a Spatial*DataFrame object for providing summary locations,
                       i.e. SpatialPointsDataFrame or SpatialPolygonsDataFrame
                       as defined in package <span class="pkg">sp</span></p></dd>

  <dt id="arg-vars">vars<a class="anchor" aria-label="anchor" href="#arg-vars"></a></dt>
<dd><p>a vector of variable names to be summarized</p></dd>

  <dt id="arg-bw">bw<a class="anchor" aria-label="anchor" href="#arg-bw"></a></dt>
<dd><p>bandwidth used in the weighting function</p></dd>

  <dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>function chosen as follows:</p>
<p>gaussian: wgt = exp(-.5*(vdist/bw)^2);</p>
<p>exponential: wgt = exp(-vdist/bw);</p>
<p>bisquare: wgt = (1-(vdist/bw)^2)^2 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>tricube: wgt = (1-(vdist/bw)^3)^3 if vdist &lt; bw, wgt=0 otherwise;</p>
<p>boxcar: wgt=1 if dist &lt; bw, wgt=0 otherwise</p></dd>

  <dt id="arg-adaptive">adaptive<a class="anchor" aria-label="anchor" href="#arg-adaptive"></a></dt>
<dd><p>if TRUE calculate an adaptive kernel where the bandwidth (bw) corresponds to the number of nearest neighbours (i.e. adaptive distance); default is FALSE, where a fixed kernel is found (bandwidth is a fixed distance)</p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>the power of the Minkowski distance, default is 2, i.e. the Euclidean distance</p></dd>

  <dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>an angle in radians to rotate the coordinate system, default is 0</p></dd>

  <dt id="arg-longlat">longlat<a class="anchor" aria-label="anchor" href="#arg-longlat"></a></dt>
<dd><p>if TRUE, great circle distances will be calculated</p></dd>

  <dt id="arg-dmat">dMat<a class="anchor" aria-label="anchor" href="#arg-dmat"></a></dt>
<dd><p>a pre-specified distance matrix, it can be calculated by the function <code><a href="gw.dist.html">gw.dist</a></code></p></dd>

  <dt id="arg-quantile">quantile<a class="anchor" aria-label="anchor" href="#arg-quantile"></a></dt>
<dd><p>if TRUE, median, interquartile range, quantile imbalance will be calculated</p></dd>

  <dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class “gwss”, returned by the function gwss</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments passed through (unused)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of class “lss”:</p>
<dl><dt>SDF</dt>
<dd><p>a SpatialPointsDataFrame (may be gridded) or
             SpatialPolygonsDataFrame object (see package “sp”)
             with local means,local standard deviations,local variance,
             local skew,local coefficients of variation, local covariances,
             local correlations (Pearson's), local correlations (Spearman's),
             local medians, local interquartile ranges, local quantile imbalances and coordinates.</p></dd>

  <dt>...</dt>
<dd><p>other information for reporting</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Fotheringham S, Brunsdon, C, and Charlton, M (2002),
Geographically Weighted Regression: The Analysis of Spatially Varying Relationships, Chichester: Wiley.</p>
<p>Brunsdon C, Fotheringham AS, Charlton ME (2002) Geographically weighted summary statistics - a framework for localised exploratory data analysis. Computers, Environment and Urban Systems 26:501-524</p>
<p>Harris P, Clarke A, Juggins S, Brunsdon C, Charlton M (2014) Geographically
weighted methods and their use in network re-designs for environmental monitoring.
Stochastic Environmental Research and Risk Assessment 28: 1869-1887</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Binbin Lu <a href="mailto:binbinlu@whu.edu.cn">binbinlu@whu.edu.cn</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">EWHP</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">EWOutline</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ewhp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">houses.spdf</span> <span class="op">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span><span class="op">(</span><span class="va">ewhp</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">ewhp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">localstats1</span> <span class="op">&lt;-</span> <span class="fu">gwss</span><span class="op">(</span><span class="va">houses.spdf</span>, vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PurPrice"</span>, <span class="st">"FlrArea"</span><span class="op">)</span>, bw <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">localstats1</span><span class="op">$</span><span class="va">SDF</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">localstats1</span></span></span>
<span class="r-in"><span><span class="co">##A function for mapping data</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="va">quick.map</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">spdf</span>,<span class="va">var</span>,<span class="va">legend.title</span>,<span class="va">main.title</span><span class="op">)</span> </span></span>
<span class="r-in"><span>   <span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">spdf</span><span class="op">@</span><span class="va">data</span><span class="op">[</span>,<span class="va">var</span><span class="op">]</span></span></span>
<span class="r-in"><span>     <span class="va">cut.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">x.cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">cut.vals</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">cut.levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">x.cut</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">cut.band</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">x.cut</span>,<span class="va">cut.levels</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cut.levels</span><span class="op">)</span>, <span class="st">"YlOrRd"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">colors</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ewoutline</span>,col<span class="op">=</span><span class="st">"olivedrab"</span>,bg<span class="op">=</span><span class="st">"lightblue1"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="va">main.title</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spdf</span>,add<span class="op">=</span><span class="cn">TRUE</span>,col<span class="op">=</span><span class="va">colors</span><span class="op">[</span><span class="va">cut.band</span><span class="op">]</span>,pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,<span class="va">cut.levels</span>,col<span class="op">=</span><span class="va">colors</span>,pch<span class="op">=</span><span class="fl">16</span>,bty<span class="op">=</span><span class="st">"n"</span>,title<span class="op">=</span><span class="va">legend.title</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="fu">quick.map</span><span class="op">(</span><span class="va">localstats1</span><span class="op">$</span><span class="va">SDF</span>, <span class="st">"PurPrice_LM"</span>, <span class="st">"1000's Uk Pounds"</span>, </span></span>
<span class="r-in"><span>  <span class="st">"Geographically Weighted Mean"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">quick.map</span><span class="op">(</span><span class="va">localstats1</span><span class="op">$</span><span class="va">SDF</span>, <span class="st">"PurPrice_LSKe"</span>, <span class="st">"Skewness Level"</span>, <span class="st">"Local Skewness"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">quick.map</span><span class="op">(</span><span class="va">localstats1</span><span class="op">$</span><span class="va">SDF</span>, <span class="st">"PurPrice_LSD"</span>, <span class="st">"1000's Pounds"</span>, <span class="st">"Local Standard Deviation"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">#Exploring Non-Stationarity of Relationships</span></span></span>
<span class="r-in"><span>  <span class="fu">quick.map</span><span class="op">(</span><span class="va">localstats1</span><span class="op">$</span><span class="va">SDF</span>, <span class="st">"Corr_PurPrice.FlrArea"</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">rho</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  <span class="st">"Geographically Weighted Pearson Correlation"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">#Robust, Quantile Based Local Summary Statistics</span></span></span>
<span class="r-in"><span>  <span class="va">localstats2</span> <span class="op">&lt;-</span> <span class="fu">gwss</span><span class="op">(</span><span class="va">houses.spdf</span>, vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PurPrice"</span>, <span class="st">"FlrArea"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  bw <span class="op">=</span> <span class="fl">50000</span>, quantile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">quick.map</span><span class="op">(</span><span class="va">localstats2</span><span class="op">$</span><span class="va">SDF</span>, <span class="st">"PurPrice_Median"</span>, <span class="st">"1000 UK Pounds"</span>, </span></span>
<span class="r-in"><span>  <span class="st">"Geographically Weighted Median House Price"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Binbin Lu, Paul Harris, Martin Charlton, Chris Brunsdon, Tomoki Nakaya.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

